import{d as $,o as l,c as r,a as s,t as f,r as g,F as h,b as y,e as N,g as V,w as _,v as x,f as v,h as k,i as E,j as O,k as w,L as j,l as D}from"./index-0246b8dd.js";async function M(p){const a="https://script.google.com/macros/s/AKfycbzhZvb85DvQf37xZopLurDFjzwlIdWMxkcPJN9yFUu2E7lga3c-7s-bu3EYHGsgJ4n7/exec";try{console.log("sending data"),console.log(JSON.stringify(p));const c=await fetch(a,{method:"POST",body:JSON.stringify(p)});if(c.ok){const u=await c.json();console.log("Data sent successfully:",u)}else console.error("Error sending data:",c.status,c.statusText)}catch(c){console.error("Error sending data:",c)}}const U={class:"text-lg mt-3"},C={class:"flex gap-6"},L={class:"w-1/2"},T=s("label",{class:"block text-sm text-neutral-500",for:""},"Stock on hand",-1),A={class:"w-1/2"},J=s("label",{class:"block text-sm text-neutral-500",for:""},"Expiry date",-1),z=$({__name:"batch",props:{batchNumber:{}},setup(p){return(a,c)=>(l(),r(h,null,[s("p",U,"Batch "+f(a.batchNumber),1),s("div",C,[s("div",L,[g(a.$slots,"stock"),T]),s("div",A,[g(a.$slots,"expiry"),J])])],64))}}),I={class:"w-full max-w-lg m-auto bg-white p-8 md:shadow-md md:rounded-md"},P=s("h1",{class:"text-3xl mb-6 font-extrabold"},"Drug stock form",-1),Y={key:0},Z=s("label",{class:"block text-xl font-medium mb-2",for:""},"Facility name",-1),G=s("option",{value:"",disabled:"",selected:""},"Select facility",-1),H=["value"],K=s("label",{class:"block text-xl font-medium mb-2",for:""},"For end of month",-1),Q=["value"],W={class:"border-t border-slate-100 py-6"},q={class:"text-xl font-bold capitalize"},R=["onUpdate:modelValue"],X=["onUpdate:modelValue"],ee=["onClick"],te={key:1},se=s("p",{class:"uppercase text-sm font-medium mt-3 py-2 text-neutral-600"}," max three batches per medicine",-1),oe=s("p",{class:"text-sm text-neutral-500 mt-2"},"If you have more than 3 batches then add any additional batch stocks to batch 3 using the same date",-1),ae=[se,oe],le={key:1,class:"py-10"},ne=s("p",{class:"text-center uppercase text-sm text-slate-400 font-bold mt-5"},"loading",-1),ce=$({__name:"form",setup(p){const a=y({facilities:[],drugs:[],drugBatches:{}});N(async()=>{const t=await V();a.value.facilities=t.facilities,a.value.drugs=t.drugs,c(),console.log(t),n.value=B(t.rawFormFields),n.value.monthyear=b()[0]});function c(){const t={};a.value.drugs.forEach(o=>{t[o]=1}),a.value.drugBatches=t}function u(t,o,e){return`${t} b${o+1} ${e}`}const n=y({});function B(t){return t.reduce(function(o,e){return o[e]="",o},{})}function b(){for(var t=[],o=new Date,e=0;e<12;e++){var i=o.toLocaleString("default",{month:"short"}).toLowerCase(),d=o.getFullYear(),m=i+"-"+d;t.push(m),o.setMonth(o.getMonth()-1)}return t}function S(){if(console.log(new Date),console.log(n.value.facility),n.value.facility===""){console.log("no facility selected");return}const t={rowData:F(n.value)};console.log(t),M(t)}function F(t){return Object.values(t)}return(t,o)=>(l(),r("div",I,[P,a.value.facilities.length>0?(l(),r("form",Y,[Z,_(s("select",{name:"",id:"",class:"uppercase","onUpdate:modelValue":o[0]||(o[0]=e=>n.value.facility=e)},[G,(l(!0),r(h,null,v(a.value.facilities,e=>(l(),r("option",{value:e},f(e),9,H))),256))],512),[[x,n.value.facility]]),K,_(s("select",{name:"",id:"",class:"uppercase","onUpdate:modelValue":o[1]||(o[1]=e=>n.value.monthyear=e)},[(l(!0),r(h,null,v(b(),(e,i)=>(l(),r("option",{key:i,value:e},f(e),9,Q))),128))],512),[[x,n.value.monthyear]]),(l(!0),r(h,null,v(a.value.drugs,e=>(l(),r("div",W,[s("h2",q,f(e),1),(l(!0),r(h,null,v(a.value.drugBatches[e],(i,d)=>(l(),O(z,{batchNumber:i},{stock:w(()=>[_(s("input",{type:"number",class:"mt-2 mb-1","onUpdate:modelValue":m=>n.value[u(e,d,"stock")]=m},null,8,R),[[D,n.value[u(e,d,"stock")]]])]),expiry:w(()=>[_(s("input",{type:"date",class:"mt-2 mb-1","onUpdate:modelValue":m=>n.value[u(e,d,"expiry")]=m},null,8,X),[[D,n.value[u(e,d,"expiry")]]])]),_:2},1032,["batchNumber"]))),256)),a.value.drugBatches[e]<3?(l(),r("button",{key:0,onClick:k(i=>a.value.drugBatches[e]<3?a.value.drugBatches[e]+=1:void 0,["prevent"]),class:"uppercase text-sm font-medium mt-3 py-2 rounded-md text-[#0075EB]"}," + add batch ",8,ee)):(l(),r("div",te,ae))]))),256)),s("button",{class:"w-full p-3 shadow-lg border-b-2 border-blue-800 bg-blue-500 rounded-md text-lg uppercase text-white tracking-wider",onClick:o[2]||(o[2]=k(e=>S(),["prevent"]))}," submit drug stock ")])):(l(),r("div",le,[E(j),ne]))]))}});export{ce as default};
